{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Scenario",
  "type": "object",
  "properties": {
    "name": { "type": "string" },
    "prompt": { "type": "string" },
    "format": { "type": "string", "enum": ["function", "json"] },
    "expected_tools": {
      "type": "array",
      "items": { "type": "string" }
    },
    "expected_parameters": {
      "type": "object",
      "additionalProperties": {
        "type": ["object"],
        "additionalProperties": true
      }
    },
    "workflow_expectations": {
      "type": "object",
      "properties": {
        "logical_order": {
          "type": "array",
          "items": { "type": "string" }
        },
        "dependencies": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "prerequisite": { "type": "string" },
              "dependent": { "type": "string" },
              "requirement": { "type": "string" }
            },
            "required": ["prerequisite", "dependent"]
          }
        },
        "minimal_steps": { "type": "integer", "minimum": 1 },
        "context_requirements": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "source": { "type": "string" },
              "target": { "type": "string" },
              "parameter": { "type": "string" }
            },
            "required": ["source", "target", "parameter"]
          }
        },
        "required_operations": {
          "type": "array",
          "items": { "type": "string" }
        }
      },
      "additionalProperties": true
    },
    "sla_seconds": { "type": ["number", "integer"], "minimum": 1 },
    "weights_override": { "type": "object", "additionalProperties": true },
    "setup": { "type": "object", "additionalProperties": true }
  },
  "required": ["name", "prompt", "expected_tools"],
  "additionalProperties": true
}

{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://local/habit_app/schema/scenario.schema.json",
  "title": "EVX Scenario Fixture",
  "type": "object",
  "properties": {
    "name": { "type": "string" },
    "prompt": { "type": "string", "minLength": 1 },
    "complexity": { "type": "integer", "minimum": 1 },
    "extraction_gold": {
      "type": "object",
      "properties": {
        "tools": { "type": "array", "items": { "type": "string" } }
      },
      "required": ["tools"],
      "additionalProperties": true
    },
    "verification_gold": {
      "type": "object",
      "properties": {
        "tools": { "type": "array", "items": { "type": "string" } }
      },
      "required": ["tools"],
      "additionalProperties": true
    },
    "execution_gold": {
      "type": "object",
      "properties": {
        "tools": { "type": "array", "items": { "type": "string" } },
        "sequence": { "type": "array", "items": { "type": "string" } }
      },
      "additionalProperties": true,
      "oneOf": [
        { "required": ["tools"], "not": { "required": ["sequence"] } },
        { "required": ["sequence"], "not": { "required": ["tools"] } }
      ]
    },
    "param_hints": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "additionalProperties": true
      }
    },
    "setup": {
      "type": "object",
      "properties": {
        "create_todos": {
          "type": "array",
          "items": { "type": "object", "additionalProperties": true }
        }
      },
      "additionalProperties": true
    }
  },
  "required": ["prompt", "complexity"],
  "additionalProperties": true,
  "allOf": [
    {
      "anyOf": [
        { "required": ["extraction_gold"] },
        { "required": ["verification_gold"] },
        { "required": ["execution_gold"] },
        { "required": ["expected_tools"] }
      ]
    }
  ]
}


